# Хакатон Нефтекод 2025

## Цель хакатона

Разработать метод генерации молекул, который позволит создавать SMILES новых антиокислительных присадок с высокой эффективностью на основе предоставленных SMILES веществ и соответствующих им значений времени индукционного окисления рецептур масел.

Проект направлен на генерацию новых антиокислительных присадок на основе аминов и фенолов с высокой индукционной стойкостью. Разработано решение, которое находит структурные закономерности между SMILES-представлениями молекул и временем индукционного окисления, и использует их для генерации потенциально эффективных соединений. Проект выполнен в рамках хакатона «Нефтекод» по заказу нефтехимической отрасли.

## Установка и запуск

### Требования
- Python 3.8+
- pip (менеджер пакетов Python)

### Установка зависимостей
pip install -r requirements.txt

### Запуск проекта
1. Клонируйте репозиторий:
git clone https://github.com/your-username/spmm-neftecode.git
cd spmm-neftecode

2. Запустите веб-приложение:
python app.py

## Основной функционал
- Генерация новых молекул антиокислительных присадок
- Предсказание времени индукционного окисления
- Анализ стабильности молекул
- Визуализация молекулярных структур
- Веб-интерфейс для удобного взаимодействия с системой

## Технологии и инструменты
![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![RDKit](https://img.shields.io/badge/RDKit-2023.03.1-green.svg)
![Flask](https://img.shields.io/badge/Flask-2.0.1-lightgrey.svg)
![scikit-learn](https://img.shields.io/badge/scikit--learn-1.0.2-orange.svg)
![pandas](https://img.shields.io/badge/pandas-1.3.3-red.svg)
![numpy](https://img.shields.io/badge/numpy-1.21.2-yellow.svg)

## Основной функционал решения

За основу нашего решения для генерации молекул мы взяли [SPMM](https://www.nature.com/articles/s41467-024-46440-3):
[images/schema.jpg]

SPMM представляет собой мультимодальную модель, объединяющую структурные и свойственные данные молекул в едином пространстве представлений:
- SPMM позволяет генерировать структуры молекул (SMILES) на основе заданных свойств, что является ключевым требованием задачи
- Возможность учитывать множество свойств одновременно без необходимости повторного обучения модели.
- Модель обучается на данных, где свойства и структура молекул представлены как отдельные модальности. Это позволяет выявлять сложные зависимости между структурой молекулы и ее антиокислительными характеристиками
- SPMM демонстрирует высокую точность при генерации молекул с заданными свойствами и предсказании свойств для новых структур. Это делает ее подходящей для поиска новых антиоксидантов с целевыми характеристиками

Для ретросинтетического анализа использовали `rxn4chemestry`. Для проверки на стабильность - `MMFF94`. Для оптимизации PDSC использовали генетический алгоритм (в качестве суррогатной модели дообучили `SPMM-регрессор` на данных, собранных с лидерборда)


- [код инференса spmm](https://github.com/l1ghtsource/spmm-neftecode/blob/main/spmm-inference.ipynb) (не забудьте `pip install -r SPMM/requirements.txt`)
- [модификация кода для генерации smiles по pv](https://github.com/l1ghtsource/spmm-neftecode/blob/main/SPMM/d_pv2smiles_single.py)
- [генетический алгоритм для максимизации oit](https://github.com/l1ghtsource/spmm-neftecode/blob/main/SPMM/spmm_ga_optimization.py)
- [pdsc предиктор](https://github.com/l1ghtsource/spmm-neftecode/blob/main/SPMM/spmm_finetune_pdsc.py)
- [pdsc предиктор (вторая версия с ridge)](https://github.com/l1ghtsource/spmm-neftecode/blob/main/regressor.ipynb)
- [код ретросинтетического анализа](https://github.com/l1ghtsource/spmm-neftecode/blob/main/retrosynthesis.ipynb)
- [веб-сервис для работы с ретросинтетическим анализом](https://github.com/l1ghtsource/spmm-neftecode/blob/main/app.py) (для запуска `streamlit run app.py`)
- [код проверки молекулы на стабильность](https://github.com/l1ghtsource/spmm-neftecode/blob/main/stability.py)

Сгенерированные молекулы: [тык](https://github.com/l1ghtsource/spmm-neftecode/blob/main/generated_moleculas.csv)

Презентация: [тык](https://disk.yandex.ru/i/Y4Ys0HAat2uHtA)

Метрики регрессора PDSC:

```python
Ridge Metrics
- MSE: 852.9046
- RMSE: 29.2045
- MAE: 18.8468
- R²: 0.8655
```


## Команда проекта
- [Калинин Алексей](https://github.com/ItamMigel) - Разработка ML-моделей, проверка стабильности
- Пякилля Борис - Идеи решения задачи
- [Рыжичкин Кирилл](https://github.com/l1ghtsource) - SPMM, ретросинтез, веб-сервис
- [Жданов Максим](https://github.com/ZhdanovMax) - Молекулярное моделирование, генетический алгоритм
- [Гулякина Анна](https://github.com/Gulyakina) - Презентация

## Архитектура проекта
```
spmm-neftecode/
├── app.py                 # Веб-приложение Streamlit для ретросинтетического анализа
├── SPMM/                  # Основной модуль: реализация SPMM, генерация молекул, вспомогательные скрипты
│   ├── d_pv2smiles_single.py      # Генерация SMILES по property vector
│   ├── spmm_ga_optimization.py    # Генетический алгоритм для оптимизации свойств
│   ├── spmm_finetune_pdsc.py      # Дообучение регрессора на PDSC
│   └── ...
├── data/                  # Датасеты для обучения и тестирования моделей
├── models_ridge_440lb/    # Сохранённые обученные модели (например, Ridge)
├── spmm-inference.ipynb   # Jupyter Notebook для инференса SPMM
├── regressor.ipynb        # Jupyter Notebook для обучения/инференса регрессора
├── retrosynthesis.ipynb   # Jupyter Notebook для ретросинтетического анализа
├── gen_from_pv_exp.ipynb  # Jupyter Notebook: генерация молекул по экспериментальным данным
├── gen_from_top.ipynb     # Jupyter Notebook: генерация молекул по топовым результатам
├── stability.py           # Модуль для проверки стабильности молекул (MMFF94)
├── generated_moleculas.csv# Сгенерированные молекулы
├── requirements.txt       # Зависимости проекта
└── README.md              # Документация
```

## Скриншоты сервиса
[images/photo.jpg]

## Заключение
Проект SPMM представляет собой инновационное решение для генерации новых антиокислительных присадок. Основные преимущества:
- Использование современных методов машинного обучения
- Интеграция химических знаний в процесс генерации
- Удобный веб-интерфейс для работы с системой
- Высокая точность предсказания свойств молекул

### Планы по улучшению
- Расширение базы данных для обучения
- Улучшение точности предсказаний
- Добавление новых типов молекул
- Оптимизация производительности

## Лицензия
MIT License
